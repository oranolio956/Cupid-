(self.webpackChunkspark=self.webpackChunkspark||[]).push([[39,873],{37848:(S,C,a)=>{"use strict";a.d(C,{default:()=>b});var e=a(68275),t=a(96540),o=a(55794),s=a.n(o),P=Object.defineProperty,h=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable,w=(f,i,n)=>i in f?P(f,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):f[i]=n,N=(f,i)=>{for(var n in i||(i={}))B.call(i,n)&&w(f,n,i[n]);if(h)for(var n of h(i))K.call(i,n)&&w(f,n,i[n]);return f};function W(f){const[i,n]=(0,t.useState)(!0),[I,u]=(0,t.useState)({left:0,top:0,bottom:0,right:0}),_=(0,t.useRef)(null),T=(U,m)=>{var A;const{clientWidth:R,clientHeight:L}=window.document.documentElement,p=(A=_.current)==null?void 0:A.getBoundingClientRect();!p||i||u({left:-p.left+m.x,right:R-(p.right-m.x),top:-p.top+m.y,bottom:L-(p.bottom-m.y)})};return t.createElement(e.A,N({title:t.createElement("div",{style:{width:"100%",cursor:"move"},onMouseOver:()=>{i&&f.draggable&&n(!1)},onMouseOut:()=>{n(!0)},onFocus:()=>{},onBlur:()=>{n(!0)}},f.modalTitle),modalRender:U=>t.createElement(s(),{disabled:i||!f.draggable,bounds:I,onStart:(m,A)=>T(m,A)},t.createElement("div",{ref:_},U))},f),f.children)}const b=W},71508:S=>{function C(e){var t,o,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var P=e.length;for(t=0;t<P;t++)e[t]&&(o=C(e[t]))&&(s&&(s+=" "),s+=o)}else for(o in e)e[o]&&(s&&(s+=" "),s+=o);return s}function a(){for(var e,t,o=0,s="",P=arguments.length;o<P;o++)(e=arguments[o])&&(t=C(e))&&(s&&(s+=" "),s+=t);return s}S.exports=a,S.exports.clsx=a},80586:(S,C,a)=>{"use strict";a.d(C,{default:()=>V});var e=a(96540),t=a(75427),o=a(47730),s=a(37848),P=a(50400),h=a(79478),B=a(78027),K=a(80581),w=Object.defineProperty,N=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,f=(d,E,g)=>E in d?w(d,E,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[E]=g,i=(d,E)=>{for(var g in E||(E={}))W.call(E,g)&&f(d,g,E[g]);if(N)for(var g of N(E))b.call(E,g)&&f(d,g,E[g]);return d};let n=null,I=null,u=!1,_=null,T=null,U=0,m=0,A=0,R=0,L=o.Ay.t("DESKTOP.TITLE");function p(d){const[E,g]=(0,e.useState)("0x0"),[k,J]=(0,e.useState)(0),[X,G]=(0,e.useState)(0),H=(0,e.useCallback)(l=>{l&&d.open&&!u&&!_&&(T=(0,t.s_)((0,t.Vv)(32)),_=l,x(_),$(_))},[d]);(0,e.useEffect)(()=>{d.open||(_=null,n&&u&&(clearInterval(U),n.close(),u=!1))},[d.open]);function x(){!_||(I=_.getContext("2d",{alpha:!1}),I.imageSmoothingEnabled=!1)}function $(){I!==null&&(n!==null&&u&&n.close(),n=new WebSocket((0,t.vo)(!0,`api/device/desktop?device=${d.device.id}&secret=${(0,t.G_)(T)}`)),n.binaryType="arraybuffer",n.onopen=()=>{u=!0},n.onmessage=l=>{z(l.data,_,I)},n.onclose=()=>{u&&(u=!1,h.Ay.warn(o.Ay.t("COMMON.DISCONNECTED")))},n.onerror=l=>{console.error(l),u?(u=!1,h.Ay.warn(o.Ay.t("COMMON.DISCONNECTED"))):h.Ay.warn(o.Ay.t("COMMON.CONNECTION_FAILED"))},clearInterval(U),U=setInterval(()=>{J(A),G(m),A=0,m=0,R++,R>10&&u&&(R=0,F({act:"DESKTOP_PING"}))},1e3))}function Q(){_.requestFullscreen().catch(console.error)}function Y(){_&&d.open&&(u?F({act:"DESKTOP_SHOT"}):(x(_),$(_)))}function z(l,r,y){l=l.slice(5);let O=new DataView(l),v=O.getUint8(0);if(v===3){q(l.slice(1));return}if(v===2){let M=O.getUint16(3,!1),D=O.getUint16(5,!1);if(M===0||D===0)return;r.width=M,r.height=D,g(`${M}x${D}`);return}v===0&&m++,A+=l.byteLength;let c=1;for(;c<l.byteLength;){let M=O.getUint16(c+0,!1),D=O.getUint16(c+2,!1),ee=O.getUint16(c+4,!1),te=O.getUint16(c+6,!1),ne=O.getUint16(c+8,!1),le=O.getUint16(c+10,!1),j=M-10;c+=12,Z(l.slice(c,c+j),D,ee,te,ne,le,y),c+=j}O=null}function Z(l,r,y,O,v,c,M){switch(r){case 0:M.putImageData(new ImageData(new Uint8ClampedArray(l),v,c),y,O,0,0,v,c);break;case 1:createImageBitmap(new Blob([l]),0,0,v,c,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(D=>{M.drawImage(D,0,0,v,c,y,O,v,c)});break}}function q(l){let r=(0,t.Yc)(l,T);try{r=JSON.parse(r)}catch(y){}if((r==null?void 0:r.act)==="WARN"){h.Ay.warn(r.msg?(0,t.Tl)(r.msg):o.Ay.t("COMMON.UNKNOWN_ERROR"));return}(r==null?void 0:r.act)==="QUIT"&&(h.Ay.warn(r.msg?(0,t.Tl)(r.msg):o.Ay.t("COMMON.UNKNOWN_ERROR")),u=!1,n.close())}function F(l){if(u){let r=(0,t.w)((0,t.Sc)(JSON.stringify(l)),T),y=new Uint8Array(r.length+8);y.set(new Uint8Array([34,22,19,17,20,3]),0),y.set(new Uint8Array([r.length>>8,r.length&255]),6),y.set(r,8),n.send(y)}}return e.createElement(s.default,i({draggable:!0,maskClosable:!1,destroyOnClose:!0,modalTitle:`${L} ${E} ${(0,t.Xq)(k)}/s FPS: ${X}`,footer:null,height:480,width:940,bodyStyle:{padding:0}},d),e.createElement("canvas",{id:"painter",ref:H,style:{width:"100%",height:"100%"}}),e.createElement(P.A,{style:{right:"59px"},className:"header-button",icon:e.createElement(B.A,null),onClick:Q}),e.createElement(P.A,{style:{right:"115px"},className:"header-button",icon:e.createElement(K.A,null),onClick:Y}))}const V=p}}]);
