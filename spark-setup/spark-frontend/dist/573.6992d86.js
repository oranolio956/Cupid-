"use strict";(self.webpackChunkspark=self.webpackChunkspark||[]).push([[573,921],{86010:(h,O,t)=>{t.r(O),t.d(O,{default:()=>P});function E(a){var o,i,e="";if(typeof a=="string"||typeof a=="number")e+=a;else if(typeof a=="object")if(Array.isArray(a))for(o=0;o<a.length;o++)a[o]&&(i=E(a[o]))&&(e&&(e+=" "),e+=i);else for(o in a)a[o]&&(e&&(e+=" "),e+=o);return e}function P(){for(var a=0,o,i,e="";a<arguments.length;)(o=arguments[a++])&&(i=E(o))&&(e&&(e+=" "),e+=i);return e}},20852:(h,O,t)=>{t.r(O),t.d(O,{default:()=>r});var E=t(67294),P=t(80129),a=t.n(P),o=t(81027),i=t(9669),e=t.n(i),D=t(48086),g=t(50146),m=t(61859),U=t(82833),d=t(37240),v=t(47181);let n=null;function l(u){const[T,c]=(0,E.useState)(!!u.file),[A,L]=(0,E.useState)(0),[s,f]=(0,E.useState)(0);(0,E.useEffect)(()=>{f(0),u.file&&(c(!0),L(0))},[u.file]);function B(){if(s!==0){M();return}const y=a().stringify({device:u.device.id,path:u.path,file:u.file.name});let C=1;f(1),window.onbeforeunload=o.Vn,n=new AbortController,e().post("/api/device/file/upload?"+y,u.file,{headers:{"Content-Type":"application/octet-stream"},timeout:0,onUploadProgress:R=>{let I=Math.round(R.loaded*100/R.total);L(I)},signal:n.signal}).then(R=>{R.data.code===0?(C=2,f(2),D.ZP.success(d.ZP.t("EXPLORER.UPLOAD_SUCCESS"))):(C=3,f(3))}).catch(R=>{e().isCancel(R)?(C=4,f(4),D.ZP.error(d.ZP.t("EXPLORER.UPLOAD_ABORTED"))):(C=3,f(3),D.ZP.error(d.ZP.t("EXPLORER.UPLOAD_FAILED")+d.ZP.t("COMMON.COLON")+R.message))}).finally(()=>{n=null,window.onbeforeunload=null,setTimeout(()=>{c(!1),C===2?u.onSuccess():u.onCancel()},1500)})}function M(){if(s===0){c(!1),setTimeout(u.onCancel,300);return}if(s===1){g.Z.confirm({autoFocusButton:"cancel",content:d.ZP.t("EXPLORER.UPLOAD_CANCEL_CONFIRM"),onOk:()=>{n.abort()},okButtonProps:{danger:!0}});return}setTimeout(()=>{c(!1),setTimeout(u.onCancel,300)},1500)}function _(){switch(s){case 1:return A+"%";case 2:return d.ZP.t("EXPLORER.UPLOAD_SUCCESS");case 3:return d.ZP.t("EXPLORER.UPLOAD_FAILED");case 4:return d.ZP.t("EXPLORER.UPLOAD_ABORTED");default:return d.ZP.t("EXPLORER.UPLOAD")}}return E.createElement(v.default,{centered:!0,draggable:!0,open:T,closable:!1,keyboard:!1,maskClosable:!1,destroyOnClose:!0,confirmLoading:s===1,okText:d.ZP.t(s===1?"EXPLORER.UPLOADING":"EXPLORER.UPLOAD"),modalTitle:d.ZP.t(s===1?"EXPLORER.UPLOADING":"EXPLORER.UPLOAD"),okButtonProps:{disabled:s!==0},cancelButtonProps:{disabled:s>1},onCancel:M,onOk:B,width:550},E.createElement("div",null,E.createElement("span",{style:{whiteSpace:"nowrap",fontSize:"20px",marginRight:"10px"}},_()),E.createElement(m.Z.Text,{ellipsis:{rows:1},style:{maxWidth:"calc(100% - 140px)"}},u.file.name),E.createElement("span",{style:{whiteSpace:"nowrap"}},"\uFF08"+(0,o.BU)(u.file.size)+"\uFF09")),E.createElement(U.Z,{strokeLinecap:"butt",percent:A,showInfo:!1}))}const r=l},47181:(h,O,t)=>{t.r(O),t.d(O,{default:()=>v});var E=t(50146),P=t(67294),a=t(61193),o=t.n(a),i=Object.defineProperty,e=Object.getOwnPropertySymbols,D=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,m=(n,l,r)=>l in n?i(n,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[l]=r,U=(n,l)=>{for(var r in l||(l={}))D.call(l,r)&&m(n,r,l[r]);if(e)for(var r of e(l))g.call(l,r)&&m(n,r,l[r]);return n};function d(n){const[l,r]=(0,P.useState)(!0),[u,T]=(0,P.useState)({left:0,top:0,bottom:0,right:0}),c=(0,P.useRef)(null),A=(L,s)=>{var f;const{clientWidth:B,clientHeight:M}=window.document.documentElement,_=(f=c.current)==null?void 0:f.getBoundingClientRect();!_||l||T({left:-_.left+s.x,right:B-(_.right-s.x),top:-_.top+s.y,bottom:M-(_.bottom-s.y)})};return P.createElement(E.Z,U({title:P.createElement("div",{style:{width:"100%",cursor:"move"},onMouseOver:()=>{l&&n.draggable&&r(!1)},onMouseOut:()=>{r(!0)},onFocus:()=>{},onBlur:()=>{r(!0)}},n.modalTitle),modalRender:L=>P.createElement(o(),{disabled:l||!n.draggable,bounds:u,onStart:(s,f)=>A(s,f)},P.createElement("div",{ref:c},L))},n),n.children)}const v=d}}]);
