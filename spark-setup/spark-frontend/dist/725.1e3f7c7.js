(self.webpackChunkspark=self.webpackChunkspark||[]).push([[725,873],{1779:w=>{var P=function(){"use strict";function o(_,r,h,d){var p;typeof r=="object"&&(h=r.depth,d=r.prototype,p=r.filter,r=r.circular);var y=[],b=[],A=typeof Buffer!="undefined";typeof r=="undefined"&&(r=!0),typeof h=="undefined"&&(h=1/0);function v(m,O){if(m===null)return null;if(O==0)return m;var e,n;if(typeof m!="object")return m;if(o.__isArray(m))e=[];else if(o.__isRegExp(m))e=new RegExp(m.source,i(m)),m.lastIndex&&(e.lastIndex=m.lastIndex);else if(o.__isDate(m))e=new Date(m.getTime());else{if(A&&Buffer.isBuffer(m))return Buffer.allocUnsafe?e=Buffer.allocUnsafe(m.length):e=new Buffer(m.length),m.copy(e),e;typeof d=="undefined"?(n=Object.getPrototypeOf(m),e=Object.create(n)):(e=Object.create(d),n=d)}if(r){var a=y.indexOf(m);if(a!=-1)return b[a];y.push(m),b.push(e)}for(var C in m){var T;n&&(T=Object.getOwnPropertyDescriptor(n,C)),!(T&&T.set==null)&&(e[C]=v(m[C],O-1))}return e}return v(_,h)}o.clonePrototype=function(r){if(r===null)return null;var h=function(){};return h.prototype=r,new h};function t(_){return Object.prototype.toString.call(_)}o.__objToStr=t;function c(_){return typeof _=="object"&&t(_)==="[object Date]"}o.__isDate=c;function u(_){return typeof _=="object"&&t(_)==="[object Array]"}o.__isArray=u;function l(_){return typeof _=="object"&&t(_)==="[object RegExp]"}o.__isRegExp=l;function i(_){var r="";return _.global&&(r+="g"),_.ignoreCase&&(r+="i"),_.multiline&&(r+="m"),r}return o.__getRegExpFlags=i,o}();w.exports&&(w.exports=P)},3434:w=>{"use strict";var P=w.exports;const o=24,t=17,c=19,u=128|t,l=128|c,i=24;P.ZMLIB={ZDLE:o,XON:t,XOFF:c,ABORT_SEQUENCE:[i,i,i,i,i],strip_ignored_bytes:function(r){for(var h=r.length-1;h>=0;h--)switch(r[h]){case t:case u:case c:case l:r.splice(h,1);continue}return r},find_subarray:function(r,h){var d=0,p,y=Date.now();e:for(;d!==-1;){if(d=r.indexOf(h[0],d),d===-1)break e;for(p=1;p<h.length;p++)if(r[d+p]!==h[p]){d++;continue e}return d}return-1}}},5275:w=>{class P{encode(u){u=unescape(encodeURIComponent(u));for(var l=new Array(u.length),i=0;i<u.length;i++)l[i]=u.charCodeAt(i);return new Uint8Array(l)}}class o{decode(u){return decodeURIComponent(escape(String.fromCharCode.apply(String,u)))}}var t=w.exports;t.Text={Encoder:typeof TextEncoder!="undefined"?TextEncoder:P,Decoder:typeof TextDecoder!="undefined"?TextDecoder:o}},5555:(w,P,o)=>{"use strict";var t=w.exports;Object.assign(t,o(15584));const c=/\*\x18[AC]|\*\*\x18B/;function u(l,i){if(i<0)throw new t.Error("validation","\u201C"+l+"\u201D ("+i+") must be nonnegative.");if(i!==Math.floor(i))throw new t.Error("validation","\u201C"+l+"\u201D ("+i+") must be an integer.")}t.Validation={offer_parameters:function(i){if(!i.name)throw new t.Error("validation","Need \u201Cname\u201D!");if(typeof i.name!="string")throw new t.Error("validation","\u201Cname\u201D ("+i.name+") must be a string!");if(i=Object.assign({},i),c.test(i.name)&&console.warn("The filename "+JSON.stringify(name)+" contains characters that look like a ZMODEM header. This could corrupt the ZMODEM session; consider renaming it so that the filename doesn\u2019t contain control characters."),i.serial!==null&&i.serial!==void 0)throw new t.Error("validation","\u201Cserial\u201D is meaningless.");if(i.serial=null,["size","mode","files_remaining","bytes_remaining"].forEach(function(h){var d;switch(typeof i[h]){case"object":d=i[h]===null;break;case"undefined":i[h]=null,d=!0;break;case"number":u(h,i[h]),d=!0;break}if(!d)throw new t.Error("validation","\u201C"+h+"\u201D ("+i[h]+") must be null, undefined, or a number.")}),typeof i.mode=="number"&&(i.mode|=32768),i.files_remaining===0)throw new t.Error("validation","\u201Cfiles_remaining\u201D, if given, must be positive.");var _;switch(typeof i.mtime){case"object":if(_=!0,i.mtime instanceof Date){var r=i.mtime;if(i.mtime=Math.floor(r.getTime()/1e3),i.mtime<0)throw new t.Error("validation","\u201Cmtime\u201D ("+r+") must not be earlier than 1970.")}else i.mtime!==null&&(_=!1);break;case"undefined":i.mtime=null,_=!0;break;case"number":u("mtime",i.mtime),_=!0;break}if(!_)throw new t.Error("validation","\u201Cmtime\u201D ("+i.mtime+") must be null, undefined, a Date, or a number.");return i}}},8136:(w,P,o)=>{"use strict";o.d(P,{default:()=>ce});var t=o(96540),c=o(50400),u=o(11721),l=o(19973),i=o(79478),_=o(40570),r=o(62975),h=o.n(r),d=o(98727),p=o.n(d),y=o(29195),b=o.n(y),A=o(38221),v=o.n(A),m=o(74633),O=o.n(m),e=o(55065),n=o(47730),a=o(75427),C=o(37848);const T=o(36320);let M=null,D=null,f=null,k=null,s=null,Z=null,F=null,S=null,Q=!1,W=!1,_e=0,j={content:"",output:""};function oe(q){let X=q.device.os,G=(0,t.createRef)(),ie=(0,t.useCallback)(x=>{x!==null&&(ie.current=x,q.open&&(F=(0,a.s_)((0,a.Vv)(32)),k=new y.FitAddon,f=new d.WebLinksAddon,s=new r.Terminal({convertEol:!0,allowProposedApi:!0,allowTransparency:!1,cursorBlink:!0,cursorStyle:"block",fontFamily:"Hack, monospace",fontSize:16,logLevel:"off"}),Z=ne(null),s.loadAddon(k),s.open(ie.current),k.fit(),s.clear(),s.loadAddon(f),window.onresize=he,_e=setInterval(()=>{W&&re({act:"PING"})},1e4),s.focus(),fe()))},[q.open]);function le(){clearInterval(_e),D&&(D._last_header_name="ZRINIT",D.close(),D=null),W&&(re({act:"TERMINAL_KILL"}),S.onclose=null,S.close()),Z==null||Z.dispose(),Z=null,k==null||k.dispose(),k=null,f==null||f.dispose(),f=null,M=null,s==null||s.dispose(),s=null,S=null,W=!1,Q=!1}function ne(x){x==null||x.dispose(),j={content:"",output:""};let g=null;return X==="windows"?g=s.onData(I(j)):(U(),g=s.onData(B(j))),S=new WebSocket((0,a.vo)(!0,`api/device/terminal?device=${q.device.id}&secret=${(0,a.G_)(F)}`)),S.binaryType="arraybuffer",S.onopen=()=>{W=!0},S.onmessage=L=>{R(L.data,j)},S.onclose=L=>{W&&(W=!1,s.write(`
${n.Ay.t("COMMON.DISCONNECTED")}
`),F=(0,a.s_)((0,a.Vv)(32)),D!==null&&(D._last_header_name="ZRINIT",D.close(),D=null))},S.onerror=L=>{console.error(L),W?(W=!1,s.write(`
${n.Ay.t("COMMON.DISCONNECTED")}
`),F=(0,a.s_)((0,a.Vv)(32)),D!==null&&(D._last_header_name="ZRINIT",D.close(),D=null)):s.write(`
${n.Ay.t("COMMON.CONNECTION_FAILED")}
`)},g}function R(x){var g;if(x=new Uint8Array(x),x[0]===34&&x[1]===22&&x[2]===19&&x[3]===17&&x[4]===21&&x[5]===0)if(x=x.slice(8),M===null)E((0,a.ko)(x));else try{M.consume(x)}catch(L){console.error(L)}else{x=(0,a.Yc)(x,F);try{x=JSON.parse(x)}catch(L){}if(W){if((x==null?void 0:x.act)==="TERMINAL_OUTPUT"){if(x=(0,a.s_)((g=x==null?void 0:x.data)==null?void 0:g.output),M===null)E((0,a.ko)(x));else try{M.consume(x)}catch(L){console.error(L)}return}if((x==null?void 0:x.act)==="WARN"){i.Ay.warn(x.msg?(0,a.Tl)(x.msg):n.Ay.t("COMMON.UNKNOWN_ERROR"));return}if((x==null?void 0:x.act)==="QUIT"){i.Ay.warn(x.msg?(0,a.Tl)(x.msg):n.Ay.t("COMMON.UNKNOWN_ERROR")),S.close();return}}}}function E(x){if(j.output.length>0&&(x=j.output+x,j.output=""),j.content.length>0)if(x.length>=j.content.length)x.startsWith(j.content)&&(x=x.substring(j.content.length),j.content="");else{j.output=x;return}s.write(x)}function I(x){let g="",L=0,N=0,H=[],z="",ee=0;return function(K){if(!W){(K==="\r"||K===`
`||K===" ")&&(s.write(`
${n.Ay.t("COMMON.RECONNECTING")}
`),Z=ne(Z));return}switch(K){case"\x1B[A":L>0&&L<=H.length&&(L===H.length&&(z=g,ee=N),L--,V(),g=H[L],N=g.length,s.write(g));break;case"\x1B[B":L+1<H.length?(L++,V(),g=H[L],N=g.length,s.write(g)):L+1<=H.length&&(V(),L++,g=z,N=ee,s.write(g),s.write("\x1B[D".repeat(O()(g.substring(N)))),z="",ee=0);break;case"\x1B[C":N<g.length&&(s.write("\x1B[C".repeat(O()(g[N]))),N++);break;case"\x1B[D":N>0&&(s.write("\x1B[D".repeat(O()(g[N-1]))),N--);break;case"\r":case`
`:g==="clear"||g==="cls"?(V(),s.clear()):(s.write(`
`),$(g+`
`),x.content=g+`
`),g.length>0&&H.push(g),N=0,g="",H.length>128&&(H=H.slice(H.length-128)),z="",ee=0,L=H.length;break;case"\x7F":if(g.length>0&&N>0){N--;let Y=O()(g[N]),te=g.substring(0,N),se=g.substring(N+1);g=te+se,s.write("\b".repeat(Y)),s.write(se+" ".repeat(Y)),s.write("\x1B[D".repeat(O()(se)+Y))}break;default:if(K>=String.fromCharCode(32)&&K<=String.fromCharCode(123)||K>="\xA0"){if(N<g.length){let Y=g.substring(0,N),te=g.substring(N);g=Y+K+te,s.write(K+te),s.write("\x1B[D".repeat(O()(te)))}else g+=K,s.write(K);N+=K.length}}};function V(){let K=g.substring(0,N),Y=g.substring(N);s.write("\b".repeat(O()(K))),s.write(" ".repeat(O()(g))),s.write("\b".repeat(O()(g)))}}function B(x){return function(g){if(!W){(g==="\r"||g===" ")&&(s.write(`
${n.Ay.t("COMMON.RECONNECTING")}
`),Z=ne(Z));return}ae(g)}}function U(){const x=()=>{G.current.setFileSelect(!1),D._last_header_name="ZRINIT",D.close(),D=null};M=new T.Sentry({on_retract:()=>{},on_detect:N=>{D!==null&&x(),D=N.confirm(),D.type==="send"?g(D):L(D)},to_terminal:N=>{E((0,a.ko)(new Uint8Array(N)))},sender:N=>{re(new Uint8Array(N),!0)}});function g(){return new Promise((N,H)=>{let z=document.getElementById("file-uploader"),ee=!1;z.onchange=V=>{if(G.current.setFileSelect(!1),D===null){V.target.value=null,i.Ay.warn(n.Ay.t("TERMINAL.ZMODEM_UPLOADER_CALL_TIMEOUT"));return}let K=V.target.files[0];if(K===void 0){s.write(`
`+n.Ay.t("TERMINAL.ZMODEM_UPLOADER_NO_FILE")+`
`),x(),H("NO_FILE_SELECTED");return}ee=!0,V.target.value=null,s.write(`
`+K.name+"	"+n.Ay.t("TERMINAL.ZMODEM_TRANSFER_START")+`
`),T.Browser.send_files(D,[K],{on_offer_response:(Y,te)=>{te||(s.write(Y.name+"	"+n.Ay.t("TERMINAL.ZMODEM_TRANSFER_REJECTED")+`
`),H("TRANSFER_REJECTED"))},on_file_complete:()=>{s.write(K.name+"	"+n.Ay.t("TERMINAL.ZMODEM_TRANSFER_SUCCESS")+`
`),N()}}).catch(Y=>{console.error(Y),s.write(K.name+"	"+n.Ay.t("TERMINAL.ZMODEM_TRANSFER_FAILED")+`
`),H(Y)}).finally(()=>{x()})},s.write(`
`+n.Ay.t("TERMINAL.ZMODEM_UPLOADER_TIP")),s.write(`
`+n.Ay.t("TERMINAL.ZMODEM_UPLOADER_WARNING")+`
`),G.current.setFileSelect(()=>{z.click()}),z.click(),setTimeout(()=>{ee||(s.write(`
`+n.Ay.t("TERMINAL.ZMODEM_UPLOADER_CALL_TIMEOUT")+`
`),x(),H("UPLOADER_CALL_TIMEOUT"))},1e4)})}function L(){return new Promise((N,H)=>{let z=!1,ee=!1;D.on("offer",V=>{let K=V.get_details();if(K.size>16*1024*1024)V.skip(),s.write(`
`+K.name+"	"+n.Ay.t("TERMINAL.ZMODEM_FILE_TOO_LARGE")+`
`);else{let Y=K.name,te=[];V.on("input",se=>{te.push(new Uint8Array(se))}),V.accept().then(()=>{T.Browser.save_to_disk(te,Y),s.write(`
`+K.name+"	"+n.Ay.t("TERMINAL.ZMODEM_TRANSFER_SUCCESS")+`
`),z=!0,N()}).catch(se=>{console.error(se),s.write(`
`+K.name+"	"+n.Ay.t("TERMINAL.ZMODEM_TRANSFER_FAILED")+`
`),ee=!0,H()})}}),D.on("session_end",()=>{D=null,!z&&!ee&&H()}),D.start()})}}function $(x){W&&re({act:"TERMINAL_INPUT",data:{input:(0,a.vm)(x)}})}function ae(x){if(W){if(Q&&x.length===1){let g=x.charCodeAt(0);g>=97&&g<=122?(g-=96,Q=!1,G.current.setCtrl(!1)):g>=64&&g<=95&&(g-=64,Q=!1,G.current.setCtrl(!1)),x=String.fromCharCode(g)}re({act:"TERMINAL_INPUT",data:{input:(0,a.vm)(x)}})}}function re(x,g){if(W){let L=[];if(g)if(x.length>65536){let H=0;for(;H<x.length;){let z=x.slice(H,H+65536);re(z,!0),H+=z.length}}else L=x;else L=(0,a.w)((0,a.Sc)(JSON.stringify(x)),F);let N=new Uint8Array(L.length+8);N.set(new Uint8Array([34,22,19,17,21,g?0:1]),0),N.set(new Uint8Array([L.length>>8,L.length&255]),6),N.set(L,8),S.send(N)}}function fe(){var x,g,L;let N=document.body.clientHeight,H=Math.floor(N/42),z=s==null?void 0:s.cols;(x=k==null?void 0:k.fit)==null||x.call(k),(g=s==null?void 0:s.resize)==null||g.call(s,z,H),(L=s==null?void 0:s.scrollToBottom)==null||L.call(s),W&&re({act:"TERMINAL_RESIZE",data:{cols:z,rows:H}})}function he(){typeof fe=="function"&&v()(fe,70)}function Ee(x){var g;if((g=s==null?void 0:s.focus)==null||g.call(s),!W&&x){G.current.setCtrl(!1);return}Q=x}function xe(x,g){var L;ae(x),g&&((L=s==null?void 0:s.focus)==null||L.call(s))}return t.createElement(C.default,{draggable:!0,maskClosable:!1,modalTitle:n.Ay.t("TERMINAL.TITLE"),open:q.open,onCancel:q.onCancel,bodyStyle:{padding:12},afterClose:le,destroyOnClose:!0,footer:null,height:250,width:900},t.createElement(J,{ref:G,onCtrl:Ee,onExtKey:xe,open:X!=="windows"}),t.createElement("div",{style:{padding:"0 0 0 5px",backgroundColor:"#000"},ref:ie}),t.createElement("input",{id:"file-uploader",type:"file",style:{display:"none"}}))}class J extends t.Component{constructor(X){super(X),this.open=X.open,this.open&&(this.funcKeys=[{key:"\x1BOP",label:"F1"},{key:"\x1BOQ",label:"F2"},{key:"\x1BOR",label:"F3"},{key:"\x1BOS",label:"F4"},{key:"\x1B[15~",label:"F5"},{key:"\x1B[17~",label:"F6"},{key:"\x1B[18~",label:"F7"},{key:"\x1B[19~",label:"F8"},{key:"\x1B[20~",label:"F9"},{key:"\x1B[21~",label:"F10"},{key:"\x1B[23~",label:"F11"},{key:"\x1B[24~",label:"F12"}],this.specialKeys=[{key:"\x1B[1~",label:"HOME"},{key:"\x1B[2~",label:"INS"},{key:"\x1B[3~",label:"DEL"},{key:"\x1B[4~",label:"END"},{key:"\x1B[5~",label:"PGUP"},{key:"\x1B[6~",label:"PGDN"}],this.funcMenu=t.createElement(l.A,{onClick:this.onKey.bind(this)},this.funcKeys.map(G=>t.createElement(l.A.Item,{key:G.key},G.label))),this.specialMenu=t.createElement(l.A,{onClick:this.onKey.bind(this)},this.specialKeys.map(G=>t.createElement(l.A.Item,{key:G.key},G.label))),this.state={ctrl:!1,fileSelect:!1})}onCtrl(){this.setState({ctrl:!this.state.ctrl}),this.props.onCtrl(!this.state.ctrl)}onKey(X){this.props.onExtKey(X.key,!1)}onExtKey(X){this.props.onExtKey(X,!0)}onFileSelect(){typeof this.state.fileSelect=="function"&&this.state.fileSelect()}setCtrl(X){this.setState({ctrl:X})}setFileSelect(X){this.setState({fileSelect:X})}render(){return this.open?t.createElement(_.A,{style:{paddingBottom:12}},t.createElement(t.Fragment,null,t.createElement(c.A,{type:this.state.ctrl?"primary":"default",onClick:this.onCtrl.bind(this)},"CTRL"),t.createElement(c.A,{onClick:this.onExtKey.bind(this,"\x1B")},"ESC"),t.createElement(c.A,{onClick:this.onExtKey.bind(this,"	")},"TAB")),t.createElement(t.Fragment,null,t.createElement(c.A,{onClick:this.onExtKey.bind(this,"\x1B[A")},"\u2B06"),t.createElement(c.A,{onClick:this.onExtKey.bind(this,"\x1B[B")},"\u2B07"),t.createElement(c.A,{onClick:this.onExtKey.bind(this,"\x1B[C")},"\u27A1"),t.createElement(c.A,{onClick:this.onExtKey.bind(this,"\x1B[D")},"\u2B05")),t.createElement(u.A.Button,{overlay:this.specialMenu},n.Ay.t("TERMINAL.SPECIAL_KEYS")),t.createElement(u.A.Button,{overlay:this.funcMenu},n.Ay.t("TERMINAL.FUNCTION_KEYS")),this.state.fileSelect?t.createElement(c.A,{onClick:this.onFileSelect.bind(this)},"\u9009\u62E9\u6587\u4EF6"):null):null}}const ce=oe},15584:w=>{"use strict";var P=w.exports;function o(l,i){return this.got=l.slice(0),this.expected=i.slice(0),"CRC check failed! (got: "+l.join()+"; expected: "+i.join()+")"}function t(l){return l}const c={aborted:"Session aborted",peer_aborted:"Peer aborted session",already_aborted:"Session already aborted",crc:o,validation:t};function u(l){const i=c[l];switch(typeof i){case"string":return i;case"function":var _=[].slice.call(arguments).slice(1);return i.apply(this,_)}return null}P.Error=class extends Error{constructor(i){super();var _=u.apply(this,arguments);_?(this.type=i,this.message=_):this.message=i}}},27637:(w,P,o)=>{"use strict";var t=w.exports;Object.assign(t,o(3434));var c,u;const l=t.ZMLIB.ZDLE;t.ZDLE=class de{constructor(_){this._config={},_&&this.set_escape_ctrl_chars(!!_.escape_ctrl_chars)}set_escape_ctrl_chars(_){if(typeof _!="boolean")throw"need boolean!";_!==this._config.escape_ctrl_chars&&(this._config.escape_ctrl_chars=_,this._setup_zdle_table())}escapes_ctrl_chars(){return!!this._config.escape_ctrl_chars}encode(_){if(!this._zdle_table)throw"No ZDLE encode table configured!";var r=this._zdle_table,h=this._lastcode,d=new ArrayBuffer(2*_.length),p=new Uint8Array(d),y=this._config.escape_ctrl_chars,b=0;for(c=0;c<_.length;c++){if(u=r[_[c]],!u)throw console.trace(),console.error("bad encode() call:",JSON.stringify(_)),this._lastcode=h,"Invalid octet: "+_[c];h=_[c],u===1||(y||u===2||(h&127)===64)&&(p[b]=l,b++,h^=64),p[b]=h,b++}return this._lastcode=h,_.splice(0),_.push.apply(_,new Uint8Array(d,0,b)),_}static decode(_){for(var r=_.length-1;r>=0;r--)_[r]===l&&_.splice(r,2,_[r+1]-64);return _}static splice(_,r,h){var d=0;r||(r=0);for(var p=r;p<_.length&&d<h;p++)d++,_[p]===l&&p++;if(d===h)return _.length===p-1?void 0:(_.splice(0,r),de.decode(_.splice(0,p-r)))}_setup_zdle_table(){for(var _=new Array(256),r=0;r<_.length;r++)if(r&96)_[r]=1;else switch(r){case l:case t.ZMLIB.XOFF:case t.ZMLIB.XON:case t.ZMLIB.XOFF|128:case t.ZMLIB.XON|128:_[r]=2;break;case 16:case 144:_[r]=this._config.turbo_escape?1:2;break;case 13:case 141:_[r]=this._config.escape_ctrl_chars?2:this._config.turbo_escape?1:3;break;default:_[r]=this._config.escape_ctrl_chars?2:1}this._zdle_table=_}}},36320:(w,P,o)=>{Object.assign(w.exports,o(68683),o(47451))},37848:(w,P,o)=>{"use strict";o.d(P,{default:()=>b});var t=o(68275),c=o(96540),u=o(55794),l=o.n(u),i=Object.defineProperty,_=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,d=(A,v,m)=>v in A?i(A,v,{enumerable:!0,configurable:!0,writable:!0,value:m}):A[v]=m,p=(A,v)=>{for(var m in v||(v={}))r.call(v,m)&&d(A,m,v[m]);if(_)for(var m of _(v))h.call(v,m)&&d(A,m,v[m]);return A};function y(A){const[v,m]=(0,c.useState)(!0),[O,e]=(0,c.useState)({left:0,top:0,bottom:0,right:0}),n=(0,c.useRef)(null),a=(C,T)=>{var M;const{clientWidth:D,clientHeight:f}=window.document.documentElement,k=(M=n.current)==null?void 0:M.getBoundingClientRect();!k||v||e({left:-k.left+T.x,right:D-(k.right-T.x),top:-k.top+T.y,bottom:f-(k.bottom-T.y)})};return c.createElement(t.A,p({title:c.createElement("div",{style:{width:"100%",cursor:"move"},onMouseOver:()=>{v&&A.draggable&&m(!1)},onMouseOut:()=>{m(!0)},onFocus:()=>{},onBlur:()=>{m(!0)}},A.modalTitle),modalRender:C=>c.createElement(l(),{disabled:v||!A.draggable,bounds:O,onStart:(T,M)=>a(T,M)},c.createElement("div",{ref:n},C))},A),A.children)}const b=y},39786:w=>{"use strict";var P=w.exports;const o=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102],t={};for(var c=0;c<o.length;c++)t[o[c]]=c;P.ENCODELIB={pack_u16_be:function(l){if(l>65535)throw"Number cannot exceed 16 bits: "+l;return[l>>8,l&255]},pack_u32_le:function(l){var i=l/65536;return[l&255,(l&65535)>>8,i&255,i>>8]},unpack_u16_be:function(l){return(l[0]<<8)+l[1]},unpack_u32_le:function(l){return l[0]+(l[1]<<8)+(l[2]<<16)+l[3]*16777216},octets_to_hex:function(l){for(var i=[],_=0;_<l.length;_++)i.push(o[l[_]>>4],o[l[_]&15]);return i},parse_hex_octets:function(l){for(var i=new Array(l.length/2),_=0;_<i.length;_++)i[_]=(t[l[2*_]]<<4)+t[l[1+2*_]];return i}}},47451:(w,P,o)=>{"use strict";var t=w.exports;window.Zmodem=t,Object.assign(t,o(36320));function c(u){if(u.aborted())throw new t.Error("aborted")}t.Browser={send_files:function(l,i,_){_||(_={});for(var r=[],h=0,d=i.length-1;d>=0;d--){var p=i[d];h+=p.size,r[d]={obj:p,name:p.name,size:p.size,mtime:new Date(p.lastModified),files_remaining:i.length-d,bytes_remaining:h}}var y=0;function b(){var A=r[y];return A?(y++,l.send_offer(A).then(function(m){return _.on_offer_response&&_.on_offer_response(A.obj,m),m===void 0?b():new Promise(function(O){var e=new FileReader;e.onerror=function(C){throw console.error("file read error",C),"File read error: "+C};var n;e.onprogress=function(C){C.target.result&&(n=new Uint8Array(C.target.result,m.get_offset()),c(l),m.send(n),_.on_progress&&_.on_progress(A.obj,m,n))},e.onload=function(C){n=new Uint8Array(C.target.result,m,n),c(l),m.end(n).then(function(){_.on_progress&&n.length&&_.on_progress(A.obj,m,n),_.on_file_complete&&_.on_file_complete(A.obj,m),O(b())})},e.readAsArrayBuffer(A.obj)})})):Promise.resolve()}return b()},save_to_disk:function(l,i){var _=new Blob(l),r=URL.createObjectURL(_),h=document.createElement("a");h.style.display="none",h.href=r,h.download=i,h.click(),setTimeout(()=>URL.revokeObjectURL(r),1e4)}}},47548:(w,P,o)=>{"use strict";const t=o(52566);var c=w.exports;Object.assign(c,o(15584),o(39786));var u;const l=16,i=4129,_=65535,r=1<<l-1;function h(){u=new Array(256);for(var y=l-8,b=0;b<256;b++){for(var A=b<<y&_,v=0;v<8;v++)(A&r)!==0?(A<<=1,A^=i):A<<=1;u[b]=A&_}}function d(y,b){return u||h(),u[b>>8&255]^(255&b)<<8^y}function p(y,b){var A;if(y.join()!==b.join())throw new c.Error("crc",b,y)}c.CRC={crc16:function(b){for(var A=b[0],v=1;v<b.length;v++)A=d(b[v],A);return A=d(0,d(0,A)),c.ENCODELIB.pack_u16_be(A)},crc32:function(b){return c.ENCODELIB.pack_u32_le(t.buf(b)>>>0)},verify16:function(b,A){return p(this.crc16(b),A)},verify32:function(b,A){try{p(this.crc32(b),A)}catch(v){throw v.input=b.slice(0),v}}}},48357:(w,P,o)=>{"use strict";var t=w.exports;Object.assign(t,o(39786),o(27637),o(3434),o(47548),o(15584));const c="*".charCodeAt(0),u="A".charCodeAt(0),l="B".charCodeAt(0),i="C".charCodeAt(0),_=[13,10],r=_.slice(0).concat([t.ZMLIB.XON]),h=[c,c,t.ZMLIB.ZDLE,l],d=[c,t.ZMLIB.ZDLE,u],p=[c,t.ZMLIB.ZDLE,i];t.Header=class{static trim_leading_garbage(E){var I=[],B,U,$=0;e:for(;E.length&&!U;){var ae=E.indexOf(c);if(ae===-1){B=!0;break e}else{if(I.push.apply(I,E.splice(0,ae)),E.length<2)break e;if(E[1]===c)if(E.length<h.length){if(E.join()===h.slice(0,E.length).join())break e}else E[2]===h[2]&&E[3]===h[3]&&(U=ne);else if(E[1]===t.ZMLIB.ZDLE){if(E.length<d.length)break e;E[2]===d[2]?U=G:E[2]===p[2]&&(U=le)}U||I.push(E.shift())}}return B&&I.push.apply(I,E.splice(0)),I}static parse(E){var I;if(E[1]===c)return I=ne(E),I&&[I,16];if(E[2]===u)return I=G(E,3),I&&[I,16];if(E[2]===i)return I=le(E),I&&[I,32];if(!(E.length<3))throw"Unrecognized/unsupported octets: "+E.join()}static build(E){var I=arguments.length===1?[arguments[0]]:Array.apply(null,arguments),B=oe[E];if(!B)throw"No frame class \u201C"+E+"\u201D is defined!";I.shift();var U=new(B.bind.apply(B,[null].concat(I)));return U}to_hex(){var E=this._crc_bytes();return h.concat(t.ENCODELIB.octets_to_hex(E.concat(t.CRC.crc16(E))),this._hex_header_ending)}to_binary16(E){return this._to_binary(E,d,t.CRC.crc16)}to_binary32(E){return this._to_binary(E,p,t.CRC.crc32)}constructor(){this._bytes4||(this._bytes4=[0,0,0,0])}_to_binary(E,I,B){var U=this._crc_bytes(),$=I.concat(E.encode(U.concat(B(U))));return $}_crc_bytes(){return[this.TYPENUM].concat(this._bytes4)}},t.Header.prototype._hex_header_ending=r;class y extends t.Header{}const b={CANFDX:1,CANOVIO:2,CANBRK:4,CANCRY:8,CANLZW:16,CANFC32:32,ESCCTL:64,ESC8:128};function A(R){if(!b[R])throw new t.Error("Invalid ZRINIT flag: "+R);return b[R]}class v extends t.Header{constructor(E,I){super();var B=0;I||(I=0),E.forEach(function(U){B|=A(U)}),this._bytes4=[I&255,I>>8,0,B]}get_buffer_size(){return t.ENCODELIB.unpack_u16_be(this._bytes4.slice(0,2))||void 0}can_full_duplex(){return!!(this._bytes4[3]&b.CANFDX)}can_overlap_io(){return!!(this._bytes4[3]&b.CANOVIO)}can_break(){return!!(this._bytes4[3]&b.CANBRK)}can_fcs_32(){return!!(this._bytes4[3]&b.CANFC32)}escape_ctrl_chars(){return!!(this._bytes4[3]&b.ESCCTL)}escape_8th_bit(){return!!(this._bytes4[3]&b.ESC8)}}const m={ESCCTL:64,ESC8:128};function O(R){if(!m[R])throw"Invalid ZSINIT flag: "+R;return m[R]}class e extends t.Header{constructor(E,I){super();var B=0;if(E.forEach(function(U){B|=O(U)}),this._bytes4=[0,0,0,B],I){if(I.length>31)throw"Attn sequence must be <= 31 bytes";if(I.some(function(U){return U>255}))throw"Attn sequence ("+I+") must be <256";this._data=I.concat([0])}}escape_ctrl_chars(){return!!(this._bytes4[3]&m.ESCCTL)}escape_8th_bit(){return!!(this._bytes4[3]&m.ESC8)}}class n extends t.Header{constructor(E){super(),E&&(this._bytes4=E.slice())}}n.prototype._hex_header_ending=_;const a={extended:{sparse:64},transport:[void 0,"compress","encrypt","rle"],management:[void 0,"newer_or_longer","crc","append","clobber","newer","mtime_or_length","protect","rename"],conversion:[void 0,"binary","text","resume"]},C=["extended","transport","management","conversion"],T=128,M=31,D=64;class f extends t.Header{get_options(){var E={sparse:!!(this._bytes4[0]&D)},I=this._bytes4.slice(0);return C.forEach(function(B,U){if(a[B]instanceof Array)B==="management"&&(E.skip_if_absent=!!(I[U]&T),I[U]&=M),E[B]=a[B][I[U]];else for(var $ in a[B])E[$]=!!(I[U]&a[B][$]),E[$]&&(I[U]^=a[B][$]);!E[B]&&I[U]&&(E[B]="unknown:"+I[U])}),E}}class k extends t.Header{}class s extends t.Header{}class Z extends t.Header{}class F extends t.Header{}Z.prototype._hex_header_ending=_;class S extends t.Header{constructor(E){super(),this._bytes4=t.ENCODELIB.pack_u32_le(E)}get_offset(){return t.ENCODELIB.unpack_u32_le(this._bytes4)}}class Q extends S{}class W extends S{}class _e extends S{}const j=[[y,"ZRQINIT"],[v,"ZRINIT"],[e,"ZSINIT"],[n,"ZACK"],[f,"ZFILE"],[k,"ZSKIP"],void 0,[s,"ZABORT"],[Z,"ZFIN"],[Q,"ZRPOS"],[W,"ZDATA"],[_e,"ZEOF"],[F,"ZFERR"],void 0,void 0,void 0,void 0,void 0,void 0,void 0];for(var oe={},J=0;J<j.length;J++)!j[J]||(oe[j[J][1]]=j[J][0],Object.assign(j[J][0].prototype,{TYPENUM:J,NAME:j[J][1]}));const ce=[y,v,e,n,f,k,"ZNAK",s,Z,Q,W,_e,F,"ZCRC","ZCHALLENGE","ZCOMPL","ZCAN","ZFREECNT","ZCOMMAND","ZSTDERR"];function q(R){var E=ce[R];if(typeof E=="string")throw"Received unsupported header: "+E;return X(E)}function X(R){return R.prototype instanceof S?new R(0):new R([])}function G(R){var E=t.ZDLE.splice(R,d.length,7);return E&&ie(E)}function ie(R){t.CRC.verify16(R.slice(0,5),R.slice(5));var E=R[0],I=q(E);return I._bytes4=R.slice(1,5),I}function le(R){var E=t.ZDLE.splice(R,p.length,9);if(!!E){t.CRC.verify32(E.slice(0,5),E.slice(5));var I=E[0],B=q(I);return B._bytes4=E.slice(1,5),B}}function ne(R){var E=R.indexOf(138);E===-1&&(E=R.indexOf(10));var I,B;if(E===-1){R.length>11&&(I="Invalid hex header - no LF detected within 12 bytes!");return}else if(B=R.splice(0,E),R.shift(),B.length===19){var U=B.pop();U!==13&&U!==141&&(I="Invalid hex header: (CR/)LF doesn\u2019t have CR!")}else B.length!==18&&(I="Invalid hex header: invalid number of bytes before LF!");if(I)throw I+=" ("+B.length+" bytes: "+B.join()+")",I;B.splice(0,4);var $=t.ENCODELIB.parse_hex_octets(B);return ie($)}t.Header.parse_hex=ne},52566:(w,P)=>{var o;(function(t){t(typeof DO_NOT_EXPORT_CRC=="undefined"?P:o={})})(function(t){t.version="1.2.2";function c(){for(var f=0,k=new Array(256),s=0;s!=256;++s)f=s,f=f&1?-306674912^f>>>1:f>>>1,f=f&1?-306674912^f>>>1:f>>>1,f=f&1?-306674912^f>>>1:f>>>1,f=f&1?-306674912^f>>>1:f>>>1,f=f&1?-306674912^f>>>1:f>>>1,f=f&1?-306674912^f>>>1:f>>>1,f=f&1?-306674912^f>>>1:f>>>1,f=f&1?-306674912^f>>>1:f>>>1,k[s]=f;return typeof Int32Array!="undefined"?new Int32Array(k):k}var u=c();function l(f){var k=0,s=0,Z=0,F=typeof Int32Array!="undefined"?new Int32Array(4096):new Array(4096);for(Z=0;Z!=256;++Z)F[Z]=f[Z];for(Z=0;Z!=256;++Z)for(s=f[Z],k=256+Z;k<4096;k+=256)s=F[k]=s>>>8^f[s&255];var S=[];for(Z=1;Z!=16;++Z)S[Z-1]=typeof Int32Array!="undefined"?F.subarray(Z*256,Z*256+256):F.slice(Z*256,Z*256+256);return S}var i=l(u),_=i[0],r=i[1],h=i[2],d=i[3],p=i[4],y=i[5],b=i[6],A=i[7],v=i[8],m=i[9],O=i[10],e=i[11],n=i[12],a=i[13],C=i[14];function T(f,k){for(var s=k^-1,Z=0,F=f.length;Z<F;)s=s>>>8^u[(s^f.charCodeAt(Z++))&255];return~s}function M(f,k){for(var s=k^-1,Z=f.length-15,F=0;F<Z;)s=C[f[F++]^s&255]^a[f[F++]^s>>8&255]^n[f[F++]^s>>16&255]^e[f[F++]^s>>>24]^O[f[F++]]^m[f[F++]]^v[f[F++]]^A[f[F++]]^b[f[F++]]^y[f[F++]]^p[f[F++]]^d[f[F++]]^h[f[F++]]^r[f[F++]]^_[f[F++]]^u[f[F++]];for(Z+=15;F<Z;)s=s>>>8^u[(s^f[F++])&255];return~s}function D(f,k){for(var s=k^-1,Z=0,F=f.length,S=0,Q=0;Z<F;)S=f.charCodeAt(Z++),S<128?s=s>>>8^u[(s^S)&255]:S<2048?(s=s>>>8^u[(s^(192|S>>6&31))&255],s=s>>>8^u[(s^(128|S&63))&255]):S>=55296&&S<57344?(S=(S&1023)+64,Q=f.charCodeAt(Z++)&1023,s=s>>>8^u[(s^(240|S>>8&7))&255],s=s>>>8^u[(s^(128|S>>2&63))&255],s=s>>>8^u[(s^(128|Q>>6&15|(S&3)<<4))&255],s=s>>>8^u[(s^(128|Q&63))&255]):(s=s>>>8^u[(s^(224|S>>12&15))&255],s=s>>>8^u[(s^(128|S>>6&63))&255],s=s>>>8^u[(s^(128|S&63))&255]);return~s}t.table=u,t.bstr=T,t.buf=M,t.str=D})},53827:(w,P,o)=>{var t=o(1779);w.exports=function(c,u){return c=c||{},Object.keys(u).forEach(function(l){typeof c[l]=="undefined"&&(c[l]=t(u[l]))}),c}},58134:(w,P,o)=>{"use strict";var t=w.exports;t.DEBUG=!1,Object.assign(t,o(39786),o(5275),o(27637),o(3434),o(48357),o(85360),o(5555),o(15584));const c=5e3,u=["CANFDX","CANOVIO","CANFC32"],l=!0,i="spool_uint8array",_=8192,r=8,h=[79,79],d=t.ZMLIB.ABORT_SEQUENCE;class p{constructor(){this._on_evt={},this._evt_once_index={}}_Add_event(e){this._on_evt[e]=[],this._evt_once_index[e]=[]}_get_evt_queue(e){if(!this._on_evt[e])throw"Bad event: "+e;return this._on_evt[e]}on(e,n){var a=this._get_evt_queue(e);return a.push(n),this}off(e,n){var a=this._get_evt_queue(e);if(n){var C=a.indexOf(n);if(C===-1)throw"\u201C"+n+"\u201D is not in the \u201C"+e+"\u201D queue.";a.splice(C,1)}else a.pop();return this}_Happen(e){var n=this._get_evt_queue(e),a=Array.apply(null,arguments);a.shift();var C=this;return n.forEach(function(T){T.apply(C,a)}),n.length}}t.Session=class extends p{static parse(e){var n;try{n=t.Header.parse_hex(e)}catch(a){return}if(!!n)switch(n.NAME){case"ZRQINIT":return new t.Session.Receive;case"ZRINIT":return new t.Session.Send(n)}}set_sender(e){return this._sender=e,this}has_ended(){return this._has_ended()}consume(e){if(this._before_consume(e),this._aborted)throw new t.Error("already_aborted");!e.length||(this._strip_and_enqueue_input(e),this._check_for_abort_sequence(e)||this._consume_first())}aborted(){return!!this._aborted}constructor(){super(),this._config={},this._input_buffer=[],this._Add_event("receive"),this._Add_event("garbage"),this._Add_event("session_end")}get_role(){return this.type}_trim_leading_garbage_until_header(){var e=t.Header.trim_leading_garbage(this._input_buffer);e.length&&this._Happen("garbage",e)===0&&console.debug("Garbage: ",String.fromCharCode.apply(String,e),e)}_parse_and_consume_header(){this._trim_leading_garbage_until_header();var e=t.Header.parse(this._input_buffer);if(!!e)return t.DEBUG&&this._log_header("RECEIVED HEADER",e[0]),this._consume_header(e[0]),this._last_header_name=e[0].NAME,this._last_header_crc=e[1],e[0]}_log_header(e,n){console.debug(this.type,e,n.NAME,n._bytes4.join())}_consume_header(e){this._on_receive(e);var n=this._next_header_handler&&this._next_header_handler[e.NAME];if(!n)throw console.error("Unhandled header!",e,this._next_header_handler),new t.Error("Unhandled header: "+e.NAME);this._next_header_handler=null,n.call(this,e)}_check_for_abort_sequence(){var e=t.ZMLIB.find_subarray(this._input_buffer,d);if(e!==-1)throw this._input_buffer.splice(0,e+d.length),this._aborted=!0,this._on_session_end(),new t.Error("peer_aborted")}_send_header(e){if(!this._sender)throw"Need sender!";var n=Array.apply(null,arguments),a=this._create_header_bytes(n);t.DEBUG&&this._log_header("SENDING HEADER",a[1]),this._sender(a[0]),this._last_sent_header=a[1]}_create_header_bytes(e){var n=t.Header.build.apply(t.Header,e),a=this._get_header_formatter(e[0]);return[n[a](this._zencoder),n]}_strip_and_enqueue_input(e){t.ZMLIB.strip_ignored_bytes(e),this._input_buffer.push.apply(this._input_buffer,e)}abort(){this._sender(d.concat([r,r,r,r,r])),this._aborted=!0,this._sender=function(){throw new t.Error("already_aborted")},this._on_session_end()}_on_session_end(){this._Happen("session_end")}_on_receive(e){this._Happen("receive",e)}_before_consume(){}};function y(O){return t.ZMLIB.find_subarray(O,h)===0?O.splice(0,h.length):O[0]===h[h.length-1]&&O.splice(0,1),O}t.Session.Receive=class extends t.Session{constructor(){super(),this._Add_event("offer"),this._Add_event("data_in"),this._Add_event("file_end")}_before_consume(e){if(this._bytes_after_OO)throw"PROTOCOL: Session is completed!";this._bytes_being_consumed=e}get_trailing_bytes(){if(this._aborted)return[];if(!this._bytes_after_OO)throw"PROTOCOL: Session is not completed!";return this._bytes_after_OO.slice(0)}_has_ended(){return this.aborted()||!!this._bytes_after_OO}_get_header_formatter(){return"to_hex"}_parse_and_consume_subpacket(){var e;this._last_header_crc===16?e="parse16":e="parse32";var n=t.Subpacket[e](this._input_buffer);return n&&(t.DEBUG&&console.debug(this.type,"RECEIVED SUBPACKET",n),this._consume_data(n),n.frame_end()&&(this._next_subpacket_handler=null)),n}_consume_first(){if(this._got_ZFIN){if(this._input_buffer.length<2)return;this._bytes_after_OO=y(this._bytes_being_consumed.slice(0)),this._on_session_end();return}var e;do this._next_subpacket_handler?e=this._parse_and_consume_subpacket():e=this._parse_and_consume_header();while(e&&this._input_buffer.length)}_consume_data(e){if(this._on_receive(e),!this._next_subpacket_handler)throw"PROTOCOL: Received unexpected data packet after "+this._last_header_name+" header: "+e.get_payload().join();this._next_subpacket_handler.call(this,e)}_octets_to_string(e){return this._textdecoder||(this._textdecoder=new t.Text.Decoder),this._textdecoder.decode(new Uint8Array(e))}_consume_ZFILE_data(e,n){if(this._file_info)throw"PROTOCOL: second ZFILE data subpacket received";var a=n.get_payload(),C=a.indexOf(0),T=this._octets_to_string(a.slice(0,C)),M=this._octets_to_string(a.slice(1+C)).split(" "),D=M[1]&&parseInt(M[1],8)||void 0;D&&(D=new Date(D*1e3)),this._file_info={name:T,size:M[0]?parseInt(M[0],10):null,mtime:D||null,mode:M[2]&&parseInt(M[2],8)||null,serial:M[3]&&parseInt(M[3],10)||null,files_remaining:M[4]?parseInt(M[4],10):null,bytes_remaining:M[5]?parseInt(M[5],10):null};var f=new v(e.get_options(),this._file_info,this._accept.bind(this),this._skip.bind(this));this._current_transfer=f}_consume_ZDATA_data(e){if(!this._accepted_offer)throw"PROTOCOL: Received data without accepting!";if(!this._offset_ok){console.warn("offset not ok!"),_send_ZRPOS();return}this._file_offset+=e.get_payload().length,this._on_data_in(e),e.ack_expected()&&!e.frame_end()&&this._send_header("ZACK",t.ENCODELIB.pack_u32_le(this._file_offset))}_make_promise_for_between_files(){var e=this;return new Promise(function(n){var a={ZFILE:function(C){this._next_subpacket_handler=function(T){this._next_subpacket_handler=null,this._consume_ZFILE_data(C,T),this._Happen("offer",this._current_transfer),n(this._current_transfer)}},ZSINIT:function(C){e._next_subpacket_handler=function(T){e._next_subpacket_handler=null,e._consume_ZSINIT_data(T),e._send_header("ZACK"),e._next_header_handler=a}},ZFIN:function(){this._consume_ZFIN(),n()}};e._next_header_handler=a})}_consume_ZSINIT_data(e){this._attn=e.get_payload()}start(){if(this._started)throw"Already started!";this._started=!0;var e=this._make_promise_for_between_files();return this._send_ZRINIT(),e}_accept(e){this._accepted_offer=!0,this._file_offset=e||0;var n=this,a=new Promise(function(C){var T;n._next_header_handler={ZDATA:function(D){this._consume_ZDATA(D),this._next_subpacket_handler=this._consume_ZDATA_data,this._next_header_handler={ZEOF:function(k){this._consume_ZEOF(k),this._next_subpacket_handler=null,this._make_promise_for_between_files(),C(),this._send_ZRINIT()}}}}});return this._send_ZRPOS(),a}_skip(){var e=this._make_promise_for_between_files();if(this._accepted_offer){if(!this._current_transfer)return;var n=function(){this._accepted_offer=!1,this._next_subpacket_handler=null,this._make_promise_for_between_files()}.bind(this);Object.assign(this._next_header_handler,{ZEOF:n,ZDATA:function(){n(),this._next_header_handler.ZEOF=n}.bind(this)})}return this._file_info=null,this._send_header("ZSKIP"),e}_send_ZRINIT(){this._send_header("ZRINIT",u)}_consume_ZFIN(){this._got_ZFIN=!0,this._send_header("ZFIN")}_consume_ZEOF(e){if(this._file_offset!==e.get_offset())throw"ZEOF offset mismatch; unimplemented (local: "+this._file_offset+"; ZEOF: "+e.get_offset()+")";this._on_file_end(),this._file_info=null,this._current_transfer=null}_consume_ZDATA(e){if(this._file_offset===e.get_offset())this._offset_ok=!0;else throw"Error correction is unimplemented."}_send_ZRPOS(){this._send_header("ZRPOS",this._file_offset)}_on_file_end(){this._Happen("file_end"),this._current_transfer&&(this._current_transfer._Happen("complete"),this._current_transfer=null)}_on_data_in(e){this._Happen("data_in",e),this._current_transfer&&this._current_transfer._Happen("input",e.get_payload())}},Object.assign(t.Session.Receive.prototype,{type:"receive"});var b={get_details:function(){return Object.assign({},this._file_info)},get_options:function(){return Object.assign({},this._zfile_opts)},get_offset:function(){return this._file_offset}};class A{constructor(e,n,a,C){this._file_info=e,this._file_offset=n||0,this._send=a,this._end=C}send(e){this._send(e),this._file_offset+=e.length}end(e){var n=this._end(e||[]);return e&&(this._file_offset+=e.length),n}}Object.assign(A.prototype,b);class v extends p{constructor(e,n,a,C){super(),this._zfile_opts=e,this._file_info=n,this._accept_func=a,this._skip_func=C,this._Add_event("input"),this._Add_event("complete"),this.on("input",this._input_handler)}_verify_not_skipped(){if(this._skipped)throw new t.Error("Already skipped!")}skip(){return this._verify_not_skipped(),this._skipped=!0,this._skip_func.apply(this,arguments)}accept(e){if(this._verify_not_skipped(),this._accepted)throw new t.Error("Already accepted!");switch(this._accepted=!0,e||(e={}),this._file_offset=e.offset||0,e.on_input){case null:case void 0:case"spool_array":case i:this._spool=[];break;default:if(typeof e.on_input!="function")throw"Invalid \u201Con_input\u201D: "+e.on_input}return this._input_handler_mode=e.on_input||i,this._accept_func(this._file_offset).then(this._get_spool.bind(this))}_input_handler(e){if(this._file_offset+=e.length,typeof this._input_handler_mode=="function")this._input_handler_mode(e);else{if(this._input_handler_mode===i)e=new Uint8Array(e);else if(this._input_handler_mode!=="spool_array")throw new t.Error("WTF?? _input_handler_mode = "+this._input_handler_mode);this._spool.push(e)}}_get_spool(){return this._spool}}Object.assign(v.prototype,b);const m={ZFILE:!0,ZDATA:!0};t.Session.Send=class extends t.Session{constructor(e){if(super(),e){if(e.NAME!=="ZRINIT")throw"First header should be ZRINIT, not "+e.NAME}else throw"Need first header!";this._last_header_name="ZRINIT",this._subpacket_encode_func="encode16",this._zencoder=new t.ZDLE,this._consume_ZRINIT(e),this._file_offset=0;var n=0;this._start_keepalive_on_set_sender=!0}set_sender(e){return super.set_sender(e),this._start_keepalive_on_set_sender&&(this._start_keepalive_on_set_sender=!1,this._start_keepalive()),this}_get_header_formatter(e){return m[e]?"to_binary16":"to_hex"}_start_keepalive(){if(!this._keepalive_promise){var e=this;this._keepalive_promise=new Promise(function(n){e._keepalive_timeout=setTimeout(n,c)}).then(function(){e._next_header_handler={ZACK:function(){e._got_ZSINIT_ZACK=!0}},e._send_ZSINIT(),e._keepalive_promise=null,e._start_keepalive()})}}_stop_keepalive(){this._keepalive_promise&&(clearTimeout(this._keepalive_timeout),this._keep_alive_promise=null)}_send_ZSINIT(){var e=[];this._zencoder.escapes_ctrl_chars()&&e.push("ESCCTL"),this._send_header_and_data(["ZSINIT",e],[0],"end_ack")}_consume_ZRINIT(e){if(this._last_ZRINIT=e,e.get_buffer_size())throw"Buffer size ("+e.get_buffer_size()+") is unsupported!";if(!e.can_full_duplex())throw"Half-duplex I/O is unsupported!";if(!e.can_overlap_io())throw"Non-overlap I/O is unsupported!";if(e.escape_8th_bit())throw"8-bit escaping is unsupported!";l?(this._zencoder.set_escape_ctrl_chars(!0),e.escape_ctrl_chars()||console.debug("Peer didn\u2019t request escape of all control characters. Will send ZSINIT to force recognition of escaped control characters.")):this._zencoder.set_escape_ctrl_chars(e.escape_ctrl_chars())}_ensure_receiver_escapes_ctrl_chars(){var e,n=!this._last_ZRINIT.escape_ctrl_chars()&&!this._got_ZSINIT_ZACK;if(n){var a=this;e=new Promise(function(C){a._next_header_handler={ZACK:T=>{C()}},a._send_ZSINIT()})}else e=Promise.resolve();return e}_convert_params_to_offer_payload_array(e){e=t.Validation.offer_parameters(e);var n=e.name+"\0",a=[(e.size||0).toString(10),e.mtime?e.mtime.toString(8):"0",e.mode?(32768|e.mode).toString(8):"0","0"];return e.files_remaining&&(a.push(e.files_remaining),e.bytes_remaining&&a.push(e.bytes_remaining)),n+=a.join(" "),this._string_to_octets(n)}send_offer(e){if(t.DEBUG&&console.debug("SENDING OFFER",e),!e)throw"need file params!";if(this._sending_file)throw"Already sending file!";var n=this._convert_params_to_offer_payload_array(e);this._stop_keepalive();var a=this;function C(){a._next_header_handler={ZRPOS:function(M){t.DEBUG&&console.warn("Mid-transfer ZRPOS \u2026 implementation error?"),C()}}}var T=function(){var M=new Promise(function(D){a._next_header_handler={ZSKIP:function(){a._start_keepalive(),D()},ZRPOS:function(f){a._sending_file=!0,C(),D(new A(e,f.get_offset(),a._send_interim_file_piece.bind(a),a._end_file.bind(a)))}}});return a._send_header_and_data(["ZFILE"],n,"end_ack"),delete a._sent_ZDATA,M};return l?this._ensure_receiver_escapes_ctrl_chars().then(T):T()}_send_header_and_data(e,n,a){var C=this._create_header_bytes(e),T=this._build_subpacket_bytes(n,a);C[0].push.apply(C[0],T),t.DEBUG&&(this._log_header("SENDING HEADER",C[1]),console.debug(this.type,"-- HEADER PAYLOAD:",a,T.length)),this._sender(C[0]),this._last_sent_header=C[1]}_build_subpacket_bytes(e,n){var a=t.Subpacket.build(e,n);return a[this._subpacket_encode_func](this._zencoder)}_build_and_send_subpacket(e,n){this._sender(this._build_subpacket_bytes(e,n))}_string_to_octets(e){this._textencoder||(this._textencoder=new t.Text.Encoder);var n=this._textencoder.encode(e);return Array.prototype.slice.call(n)}_send_interim_file_piece(e){return this._send_file_part(e,"no_end_no_ack"),Promise.resolve()}_ensure_we_are_sending(){if(!this._sending_file)throw"Not sending a file currently!"}_end_file(e){this._ensure_we_are_sending(),this._send_file_part(e,"end_no_ack");var n=this,a=new Promise(function(C){n._sending_file=!1,n._prepare_to_receive_ZRINIT(C)});return this._send_header("ZEOF",this._file_offset),this._file_offset=0,a}_prepare_to_receive_ZRINIT(e){this._next_header_handler={ZRINIT:function(n){this._consume_ZRINIT(n),e&&e()}}}close(){var e=this._last_header_name==="ZRINIT";if(e||(e=this._last_header_name==="ZSKIP"),e||(e=this._last_sent_header.name==="ZSINIT"&&this._last_header_name==="ZACK"),!e)throw"Can\u2019t close; last received header was \u201C"+this._last_header_name+"\u201D";var n=this,a=new Promise(function(C,T){n._next_header_handler={ZFIN:function(){n._sender(h),n._sent_OO=!0,n._on_session_end(),C()}}});return this._send_header("ZFIN"),a}_has_ended(){return this.aborted()||!!this._sent_OO}_send_file_part(e,n){this._sent_ZDATA||(this._send_header("ZDATA",this._file_offset),this._sent_ZDATA=!0);for(var a=0,C=e.length;;){var T=Math.min(a+_,C)-a,M=T+a>=C,D=e.slice(a,a+T);if(D instanceof Array||(D=Array.prototype.slice.call(D)),this._build_and_send_subpacket(D,M?n:"no_end_no_ack"),this._file_offset+=T,a+=T,a>=C)break}}_consume_first(){if(!this._parse_and_consume_header()&&this._input_buffer.join()==="67")throw"Receiver has fallen back to YMODEM."}_on_session_end(){this._stop_keepalive(),super._on_session_end()}},Object.assign(t.Session.Send.prototype,{type:"send"})},68599:w=>{w.exports=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]]},68683:(w,P,o)=>{"use strict";var t=w.exports;Object.assign(t,o(3434),o(58134));const c=20,u=21,l=[42,42,24,66,48],i=["to_terminal","on_detect","on_retract","sender"],_=42;class r{constructor(d,p,y,b){this._confirmer=p,this._denier=y,this._is_valid=b,this._session_type=d}confirm(){return this._confirmer.apply(this,arguments)}deny(){return this._denier.apply(this,arguments)}is_valid(){return this._is_valid.apply(this,arguments)}get_session_role(){return this._session_type}}t.Sentry=class{constructor(d){if(!d)throw"Need options!";var p=this;i.forEach(function(y){if(!d[y])throw"Need \u201C"+y+"\u201D!";p["_"+y]=d[y]}),this._cache=[]}_after_session_end(){this._zsession=null}consume(d){if(d instanceof Array||(d=Array.prototype.slice.call(new Uint8Array(d))),this._zsession){var p=this._zsession;if(p.consume(d),p.has_ended())p.type==="receive"?d=p.get_trailing_bytes():d=[];else return}var y=this._parse(d),b=d;if(y){let m=function(){return A._parsed_session===y},O=function(){if(!this.is_valid())throw"Stale ZMODEM session!";return y.on("garbage",A._to_terminal),y.on("session_end",A._after_session_end.bind(A)),y.set_sender(A._sender),delete A._parsed_session,A._zsession=y},e=function(){this.is_valid()};!!this._parsed_session&&(this._parsed_session.type===y.type&&(b=[]),this._on_retract()),this._parsed_session=y;var A=this;this._on_detect(new r(y.type,O,this._send_abort.bind(this),m))}else{var v=this._parsed_session;this._parsed_session=null,v&&(b.length===1&&b[0]===67&&this._send_abort(),this._on_retract())}this._to_terminal(b)}get_confirmed_session(){return this._zsession||null}_send_abort(){this._sender(t.ZMLIB.ABORT_SEQUENCE)}_parse(d){var p=this._cache;for(p.push.apply(p,d);;){let y=t.ZMLIB.find_subarray(p,l);if(y===-1)break;let b=p.splice(0,y),A;try{A=t.Session.parse(p)}catch(v){}if(!A)break;return p.length===1&&p[0]===t.ZMLIB.XON&&p.shift(),p.length?null:A}return p.splice(u),null}}},71508:w=>{function P(t){var c,u,l="";if(typeof t=="string"||typeof t=="number")l+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(c=0;c<i;c++)t[c]&&(u=P(t[c]))&&(l&&(l+=" "),l+=u)}else for(u in t)t[u]&&(l&&(l+=" "),l+=u);return l}function o(){for(var t,c,u=0,l="",i=arguments.length;u<i;u++)(t=arguments[u])&&(c=P(t))&&(l&&(l+=" "),l+=c);return l}w.exports=o,w.exports.clsx=o},74633:(w,P,o)=>{"use strict";var t=o(53827),c=o(68599),u={nul:0,control:0};w.exports=function(h){return l(h,u)},w.exports.config=function(r){return r=t(r||{},u),function(d){return l(d,r)}};function l(r,h){if(typeof r!="string")return i(r,h);for(var d=0,p=0;p<r.length;p++){var y=i(r.charCodeAt(p),h);if(y<0)return-1;d+=y}return d}function i(r,h){return r===0?h.nul:r<32||r>=127&&r<160?h.control:_(r)?0:1+(r>=4352&&(r<=4447||r==9001||r==9002||r>=11904&&r<=42191&&r!=12351||r>=44032&&r<=55203||r>=63744&&r<=64255||r>=65040&&r<=65049||r>=65072&&r<=65135||r>=65280&&r<=65376||r>=65504&&r<=65510||r>=131072&&r<=196605||r>=196608&&r<=262141))}function _(r){var h=0,d=c.length-1,p;if(r<c[0][0]||r>c[d][1])return!1;for(;d>=h;)if(p=Math.floor((h+d)/2),r>c[p][1])h=p+1;else if(r<c[p][0])d=p-1;else return!0;return!1}},85360:(w,P,o)=>{"use strict";var t=w.exports;Object.assign(t,o(47548),o(27637),o(3434),o(15584));const c=104,u=105,l=106,i=107;var _;t.Subpacket=class ue{static build(v,m){var O=_[m];if(!O)throw"No subpacket type \u201C"+m+"\u201D is defined! Try one of: "+Object.keys(_).join(", ");return new O(v)}encode16(v){return this._encode(v,t.CRC.crc16)}encode32(v){return this._encode(v,t.CRC.crc32)}get_payload(){return this._payload}static parse16(v){return ue._parse(v,2)}static parse32(v){return ue._parse(v,4)}constructor(v){this._payload=v}_encode(v,m){return v.encode(this._payload.slice(0)).concat([t.ZMLIB.ZDLE,this._frameend_num],v.encode(m(this._payload.concat(this._frameend_num))))}static _parse(v,m){for(var O,e,n={104:d,105:y,106:b,107:p},a=0;a<v.length;){if(a=v.indexOf(t.ZMLIB.ZDLE,a),a===-1)return;var C=v[a+1];if(e=n[C],e){O=a+1;break}a++}if(!!e){var T=v[O];if(v[O-1]!==t.ZMLIB.ZDLE)throw"Byte before frame end should be ZDLE, not "+v[O-1];var M=v.splice(0,O-1),D=t.ZDLE.splice(v,2,m);if(!D){v.unshift.apply(v,M);return}var f=t.ZDLE.decode(M);return t.CRC[m===2?"verify16":"verify32"](f.concat([T]),D),new e(f,D)}}};class r extends t.Subpacket{frame_end(){return!0}}class h extends t.Subpacket{frame_end(){return!1}}class d extends r{ack_expected(){return!1}}d.prototype._frameend_num=c;class p extends r{ack_expected(){return!0}}p.prototype._frameend_num=i;class y extends h{ack_expected(){return!1}}y.prototype._frameend_num=u;class b extends h{ack_expected(){return!0}}b.prototype._frameend_num=l,_={end_no_ack:d,end_ack:p,no_end_no_ack:y,no_end_ack:b}}}]);
