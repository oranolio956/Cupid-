(self.webpackChunkspark=self.webpackChunkspark||[]).push([[804,873],{37848:(L,P,e)=>{"use strict";e.d(P,{default:()=>U});var t=e(68275),n=e(96540),i=e(55794),a=e.n(i),_=Object.defineProperty,A=Object.getOwnPropertySymbols,R=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,C=(l,o,r)=>o in l?_(l,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[o]=r,y=(l,o)=>{for(var r in o||(o={}))R.call(o,r)&&C(l,r,o[r]);if(A)for(var r of A(o))v.call(o,r)&&C(l,r,o[r]);return l};function u(l){const[o,r]=(0,n.useState)(!0),[E,T]=(0,n.useState)({left:0,top:0,bottom:0,right:0}),d=(0,n.useRef)(null),M=(D,s)=>{var c;const{clientWidth:h,clientHeight:g}=window.document.documentElement,O=(c=d.current)==null?void 0:c.getBoundingClientRect();!O||o||T({left:-O.left+s.x,right:h-(O.right-s.x),top:-O.top+s.y,bottom:g-(O.bottom-s.y)})};return n.createElement(t.A,y({title:n.createElement("div",{style:{width:"100%",cursor:"move"},onMouseOver:()=>{o&&l.draggable&&r(!1)},onMouseOut:()=>{r(!0)},onFocus:()=>{},onBlur:()=>{r(!0)}},l.modalTitle),modalRender:D=>n.createElement(a(),{disabled:o||!l.draggable,bounds:E,onStart:(s,c)=>M(s,c)},n.createElement("div",{ref:d},D))},l),l.children)}const U=u},54055:(L,P,e)=>{"use strict";e.d(P,{default:()=>r});var t=e(96540),n=e(55373),i=e.n(n),a=e(75427),_=e(72505),A=e.n(_),R=e(79478),v=e(68275),C=e(57427),y=e(26493),u=e(47730),U=e(37848);let l=null;function o(E){const[T,d]=(0,t.useState)(!!E.file),[M,D]=(0,t.useState)(0),[s,c]=(0,t.useState)(0);(0,t.useEffect)(()=>{c(0),E.file&&(d(!0),D(0))},[E.file]);function h(){if(s!==0){g();return}const I=i().stringify({device:E.device.id,path:E.path,file:E.file.name});let m=1;c(1),window.onbeforeunload=a.V3,l=new AbortController,A().post("/api/device/file/upload?"+I,E.file,{headers:{"Content-Type":"application/octet-stream"},timeout:0,onUploadProgress:f=>{let B=Math.round(f.loaded*100/f.total);D(B)},signal:l.signal}).then(f=>{f.data.code===0?(m=2,c(2),R.Ay.success(u.Ay.t("EXPLORER.UPLOAD_SUCCESS"))):(m=3,c(3))}).catch(f=>{A().isCancel(f)?(m=4,c(4),R.Ay.error(u.Ay.t("EXPLORER.UPLOAD_ABORTED"))):(m=3,c(3),R.Ay.error(u.Ay.t("EXPLORER.UPLOAD_FAILED")+u.Ay.t("COMMON.COLON")+f.message))}).finally(()=>{l=null,window.onbeforeunload=null,setTimeout(()=>{d(!1),m===2?E.onSuccess():E.onCancel()},1500)})}function g(){if(s===0){d(!1),setTimeout(E.onCancel,300);return}if(s===1){v.A.confirm({autoFocusButton:"cancel",content:u.Ay.t("EXPLORER.UPLOAD_CANCEL_CONFIRM"),onOk:()=>{l.abort()},okButtonProps:{danger:!0}});return}setTimeout(()=>{d(!1),setTimeout(E.onCancel,300)},1500)}function O(){switch(s){case 1:return M+"%";case 2:return u.Ay.t("EXPLORER.UPLOAD_SUCCESS");case 3:return u.Ay.t("EXPLORER.UPLOAD_FAILED");case 4:return u.Ay.t("EXPLORER.UPLOAD_ABORTED");default:return u.Ay.t("EXPLORER.UPLOAD")}}return t.createElement(U.default,{centered:!0,draggable:!0,open:T,closable:!1,keyboard:!1,maskClosable:!1,destroyOnClose:!0,confirmLoading:s===1,okText:u.Ay.t(s===1?"EXPLORER.UPLOADING":"EXPLORER.UPLOAD"),modalTitle:u.Ay.t(s===1?"EXPLORER.UPLOADING":"EXPLORER.UPLOAD"),okButtonProps:{disabled:s!==0},cancelButtonProps:{disabled:s>1},onCancel:g,onOk:h,width:550},t.createElement("div",null,t.createElement("span",{style:{whiteSpace:"nowrap",fontSize:"20px",marginRight:"10px"}},O()),t.createElement(y.A.Text,{ellipsis:{rows:1},style:{maxWidth:"calc(100% - 140px)"}},E.file.name),t.createElement("span",{style:{whiteSpace:"nowrap"}},"\uFF08"+(0,a.Xq)(E.file.size)+"\uFF09")),t.createElement(C.A,{strokeLinecap:"butt",percent:M,showInfo:!1}))}const r=o},71508:L=>{function P(t){var n,i,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var _=t.length;for(n=0;n<_;n++)t[n]&&(i=P(t[n]))&&(a&&(a+=" "),a+=i)}else for(i in t)t[i]&&(a&&(a+=" "),a+=i);return a}function e(){for(var t,n,i=0,a="",_=arguments.length;i<_;i++)(t=arguments[i])&&(n=P(t))&&(a&&(a+=" "),a+=n);return a}L.exports=e,L.exports.clsx=e}}]);
